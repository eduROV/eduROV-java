<!DOCTYPE html>
<html>
<body>
  <!-- Video element to display the stream -->
  <video id="video" width="640" height="480" controls autoplay muted playsinline></video>
  
  <script>
    const video = document.getElementById('video');
    const mediaSource = new MediaSource(); // Create a MediaSource
    video.src = URL.createObjectURL(mediaSource); // Assign it to the video element

    mediaSource.addEventListener('sourceopen', sourceOpen, { once: true });

    function sourceOpen() {
      // Create a SourceBuffer for the MediaSource
      const sourceBuffer = mediaSource.addSourceBuffer('video/mp4; codecs="avc1.42E01E"');

      // Connect to the WebSocket server
      const ws = new WebSocket('ws://edurov.local:8080');

      ws.onmessage = function(event) {
        // Append each chunk of data to the SourceBuffer
        if (sourceBuffer && !sourceBuffer.updating && mediaSource.readyState === 'open') {
          sourceBuffer.appendBuffer(new Uint8Array(event.data));
        }
      };
    }
  </script>
</body>
</html>
